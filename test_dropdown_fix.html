<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Model Selection Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; }
        select { width: 300px; padding: 8px; margin: 5px 0; }
        select:disabled { opacity: 0.5; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üîç Model Selection Debug Test</h1>
    
    <div class="section">
        <h3>Direct API Test</h3>
        <label>Provider:</label><br>
        <select id="testProvider">
            <option value="">Select Provider...</option>
            <option value="Claude">Claude</option>
            <option value="OpenAI">OpenAI</option>
            <option value="Gemini">Gemini</option>
        </select><br>
        
        <label>Model:</label><br>
        <select id="testModel" disabled>
            <option value="">First select a provider...</option>
        </select>
        
        <div id="testResult"></div>
    </div>
    
    <div class="section">
        <h3>OpenRouter Test</h3>
        <label>Provider:</label><br>
        <select id="testOpenrouterProvider">
            <option value="">Select Provider...</option>
            <option value="anthropic">Anthropic</option>
            <option value="openai">OpenAI</option>
        </select><br>
        
        <label>Model:</label><br>
        <select id="testOpenrouterModel" disabled>
            <option value="">First select a provider...</option>
        </select>
        
        <div id="testOpenrouterResult"></div>
    </div>

    <script>
        // Test model data (simplified)
        const testModelData = {
            "Claude": {
                "Claude Sonnet 4": "claude-sonnet-4-20250514",
                "Claude Opus 4": "claude-opus-4-20250514",
                "Claude Haiku 3.5": "claude-3-5-haiku-20241022"
            },
            "OpenAI": {
                "GPT-4o": "gpt-4o",
                "GPT-4o Mini": "gpt-4o-mini",
                "GPT-4 Turbo": "gpt-4-turbo"
            },
            "Gemini": {
                "Gemini 2.5 Pro": "gemini-2.5-pro",
                "Gemini 2.5 Flash": "gemini-2.5-flash"
            }
        };
        
        const testOpenrouterData = {
            "anthropic": {
                "Claude Opus 4.1": "anthropic/claude-opus-4.1"
            },
            "openai": {
                "GPT-5 Mini": "openai/gpt-5-mini",
                "GPT-4o": "openai/gpt-4o"
            }
        };
        
        function loadTestModels(provider) {
            const modelSelect = document.getElementById('testModel');
            const resultDiv = document.getElementById('testResult');
            
            console.log('Loading models for provider:', provider);
            
            if (!provider) {
                modelSelect.disabled = true;
                modelSelect.innerHTML = '<option value="">First select a provider...</option>';
                resultDiv.innerHTML = '';
                return;
            }

            const models = testModelData[provider];
            
            if (!models) {
                modelSelect.innerHTML = '<option value="">No models available</option>';
                modelSelect.disabled = true;
                resultDiv.innerHTML = '<span class="error">‚ùå No models found for ' + provider + '</span>';
                return;
            }
            
            modelSelect.innerHTML = '<option value="">Select model...</option>';
            
            Object.entries(models).forEach(([displayName, modelId]) => {
                const option = document.createElement('option');
                option.value = modelId;
                option.textContent = displayName;
                modelSelect.appendChild(option);
            });
            
            modelSelect.disabled = false;
            resultDiv.innerHTML = '<span class="success">‚úÖ Loaded ' + Object.keys(models).length + ' models</span>';
            
            console.log('Successfully loaded', Object.keys(models).length, 'models for', provider);
        }
        
        function loadTestOpenrouterModels(provider) {
            const modelSelect = document.getElementById('testOpenrouterModel');
            const resultDiv = document.getElementById('testOpenrouterResult');
            
            console.log('Loading OpenRouter models for provider:', provider);
            
            if (!provider) {
                modelSelect.disabled = true;
                modelSelect.innerHTML = '<option value="">First select a provider...</option>';
                resultDiv.innerHTML = '';
                return;
            }

            const models = testOpenrouterData[provider];
            
            if (!models) {
                modelSelect.innerHTML = '<option value="">No models available</option>';
                modelSelect.disabled = true;
                resultDiv.innerHTML = '<span class="error">‚ùå No models found for ' + provider + '</span>';
                return;
            }
            
            modelSelect.innerHTML = '<option value="">Select model...</option>';
            
            Object.entries(models).forEach(([displayName, modelId]) => {
                const option = document.createElement('option');
                option.value = modelId;
                option.textContent = displayName;
                modelSelect.appendChild(option);
            });
            
            modelSelect.disabled = false;
            resultDiv.innerHTML = '<span class="success">‚úÖ Loaded ' + Object.keys(models).length + ' models</span>';
            
            console.log('Successfully loaded', Object.keys(models).length, 'OpenRouter models for', provider);
        }
        
        // Set up event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, setting up event listeners');
            
            document.getElementById('testProvider').addEventListener('change', function() {
                console.log('Provider changed to:', this.value);
                loadTestModels(this.value);
            });
            
            document.getElementById('testOpenrouterProvider').addEventListener('change', function() {
                console.log('OpenRouter provider changed to:', this.value);
                loadTestOpenrouterModels(this.value);
            });
            
            console.log('Event listeners set up successfully');
        });
    </script>
</body>
</html>
